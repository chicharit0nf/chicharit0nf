<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Modelo &mdash; MiProyecto 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=d45e8c67"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Controlador" href="controlador.html" />
    <link rel="prev" title="Vista" href="vista.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            MiProyecto
          </a>
              <div class="version">
                0.0.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contenido:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introducci%C3%B3n.html">Introduccion</a></li>
<li class="toctree-l1"><a class="reference internal" href="introducci%C3%B3n.html#manual-para-el-usuario">Manual para el Usuario</a></li>
<li class="toctree-l1"><a class="reference internal" href="vista.html">Vista</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Modelo</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#modulos-importados">Modulos Importados</a></li>
<li class="toctree-l2"><a class="reference internal" href="#clases">Clases</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#modelo.BaseModel"><code class="docutils literal notranslate"><span class="pre">BaseModel</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#modelo.Clientes"><code class="docutils literal notranslate"><span class="pre">Clientes</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#modelo.Clientes.DoesNotExist"><code class="docutils literal notranslate"><span class="pre">Clientes.DoesNotExist</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modelo.Clientes.apellido"><code class="docutils literal notranslate"><span class="pre">Clientes.apellido</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modelo.Clientes.clave_fiscal"><code class="docutils literal notranslate"><span class="pre">Clientes.clave_fiscal</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modelo.Clientes.cuit"><code class="docutils literal notranslate"><span class="pre">Clientes.cuit</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modelo.Clientes.id"><code class="docutils literal notranslate"><span class="pre">Clientes.id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modelo.Clientes.nombre"><code class="docutils literal notranslate"><span class="pre">Clientes.nombre</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modelo.Clientes.rubro"><code class="docutils literal notranslate"><span class="pre">Clientes.rubro</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#modelo.ManejoErrores"><code class="docutils literal notranslate"><span class="pre">ManejoErrores</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#modelo.ManejoErrores.registrar_error"><code class="docutils literal notranslate"><span class="pre">ManejoErrores.registrar_error()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modelo.ManejoErrores.registrar_movimiento"><code class="docutils literal notranslate"><span class="pre">ManejoErrores.registrar_movimiento()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#modelo.FuncionesBotonera"><code class="docutils literal notranslate"><span class="pre">FuncionesBotonera</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#modelo.FuncionesBotonera.abrir_afip"><code class="docutils literal notranslate"><span class="pre">FuncionesBotonera.abrir_afip()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modelo.FuncionesBotonera.actualizar_treeview"><code class="docutils literal notranslate"><span class="pre">FuncionesBotonera.actualizar_treeview()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modelo.FuncionesBotonera.alta"><code class="docutils literal notranslate"><span class="pre">FuncionesBotonera.alta()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modelo.FuncionesBotonera.borrar"><code class="docutils literal notranslate"><span class="pre">FuncionesBotonera.borrar()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modelo.FuncionesBotonera.consultar"><code class="docutils literal notranslate"><span class="pre">FuncionesBotonera.consultar()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modelo.FuncionesBotonera.maximizar_minimizar_ventana"><code class="docutils literal notranslate"><span class="pre">FuncionesBotonera.maximizar_minimizar_ventana()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modelo.FuncionesBotonera.modificar"><code class="docutils literal notranslate"><span class="pre">FuncionesBotonera.modificar()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modelo.FuncionesBotonera.mostrar_mensaje"><code class="docutils literal notranslate"><span class="pre">FuncionesBotonera.mostrar_mensaje()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modelo.FuncionesBotonera.toggle_password"><code class="docutils literal notranslate"><span class="pre">FuncionesBotonera.toggle_password()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modelo.FuncionesBotonera.validar_campos"><code class="docutils literal notranslate"><span class="pre">FuncionesBotonera.validar_campos()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="controlador.html">Controlador</a></li>
<li class="toctree-l1"><a class="reference internal" href="resolucion.html">Conclusiones</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MiProyecto</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Modelo</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/modelo.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="modelo">
<h1>Modelo<a class="headerlink" href="#modelo" title="Link to this heading"></a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>El archivo de modelo define la estructura de la base de datos utilizada en la aplicación. Contiene la definición de la tabla ‘Clientes’, que incluye campos como nombre, apellido, rubro, CUIT y clave fiscal. Utiliza la librería Peewee para interactuar con la base de datos SQLite.</p>
</div>
<section id="modulos-importados">
<h2>Modulos Importados<a class="headerlink" href="#modulos-importados" title="Link to this heading"></a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tkinter</span> <span class="kn">import</span> <span class="o">*</span>
<span class="sd">&quot;&quot;&quot;- Interfaz estándar de Python para el kit de herramientas Tk GUI. Proporciona clases y funciones para crear interfaces gráficas de usuario.&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">tkinter.messagebox</span> <span class="kn">import</span> <span class="o">*</span>
<span class="sd">&quot;&quot;&quot;- Proporciona una clase para crear cuadros de diálogo y mostrar mensajes de forma modal. Es útil para mostrar mensajes de error, advertencia o información.&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">peewee</span> <span class="kn">import</span> <span class="o">*</span>
<span class="sd">&quot;&quot;&quot;- Peewee es un ORM (Mapeo Objeto-Relacional) simple y pequeño para Python. Facilita la interacción con bases de datos relacionales a través de objetos Python.&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">webbrowser</span>
<span class="sd">&quot;&quot;&quot;- Proporciona una interfaz para abrir y controlar navegadores web. Útil para abrir URLs en el navegador predeterminado del sistema.&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">datetime</span>
<span class="sd">&quot;&quot;&quot;- Proporciona clases para manipular fechas y horas en Python. Permite crear objetos de fecha y hora, y realizar operaciones como comparaciones y cálculos de diferencia.&quot;&quot;&quot;</span>
</pre></div>
</div>
</section>
<section id="clases">
<h2>Clases<a class="headerlink" href="#clases" title="Link to this heading"></a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Estas clases están diseñadas para facilitar el manejo de una base de datos de clientes, asegurando un registro correcto de la información y la interacción con el usuario.</p>
</div>
<p class="rubric" id="module-modelo">:: BaseModel</p>
<hr class="docutils" />
<ul class="simple">
<li><p>Clase base para el modelo de la base de datos. Define la configura de la base de datos que será utilizada por el modelo de datos de la aplicación.</p></li>
</ul>
<dl class="py class">
<dt class="sig sig-object py" id="modelo.BaseModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modelo.</span></span><span class="sig-name descname"><span class="pre">BaseModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelo.html#BaseModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelo.BaseModel" title="Link to this definition"></a></dt>
<dd></dd></dl>

<img alt="i1.png" src="i1.png" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">BaseModel</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
<span class="w">   </span><span class="sd">&quot;&quot;&quot;- Clase base para el modelo de la base de datos.</span>
<span class="sd">   &quot;&quot;&quot;</span>
   <span class="k">class</span> <span class="nc">Meta</span><span class="p">():</span>
<span class="w">      </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      :param database: creamos con nombre nuestra base de datos. &quot;&quot;&quot;</span>
      <span class="n">database</span> <span class="o">=</span> <span class="n">midb</span>
</pre></div>
</div>
<p class="rubric">:: Clientes</p>
<hr class="docutils" />
<ul class="simple">
<li><p>Clase que representa la tabla ‘Clientes’ en la base de datos. Define los campos necesarios para almacenar la información de los clientes, como nombre, apellido, rubro, CUIT y clave fiscal.</p></li>
</ul>
<dl class="py class">
<dt class="sig sig-object py" id="modelo.Clientes">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modelo.</span></span><span class="sig-name descname"><span class="pre">Clientes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelo.html#Clientes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelo.Clientes" title="Link to this definition"></a></dt>
<dd><ul class="simple">
<li><p>Clase que representa la tabla ‘Clientes’ en la base de datos.</p></li>
</ul>
<p>defininimos entonces…</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nombre</strong> – Nombre del cliente.</p></li>
<li><p><strong>apellido</strong> – Apellido del cliente.</p></li>
<li><p><strong>rubro</strong> – Rubro u oficio del cliente.</p></li>
<li><p><strong>cuit</strong> – CUIT/CUIL del cliente.</p></li>
<li><p><strong>clave_fiscal</strong> – Clave fiscal del cliente.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="modelo.Clientes.DoesNotExist">
<span class="sig-name descname"><span class="pre">DoesNotExist</span></span><a class="headerlink" href="#modelo.Clientes.DoesNotExist" title="Link to this definition"></a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">ClientesDoesNotExist</span></code></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modelo.Clientes.apellido">
<span class="sig-name descname"><span class="pre">apellido</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;CharField:</span> <span class="pre">Clientes.apellido&gt;</span></em><a class="headerlink" href="#modelo.Clientes.apellido" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modelo.Clientes.clave_fiscal">
<span class="sig-name descname"><span class="pre">clave_fiscal</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;CharField:</span> <span class="pre">Clientes.clave_fiscal&gt;</span></em><a class="headerlink" href="#modelo.Clientes.clave_fiscal" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modelo.Clientes.cuit">
<span class="sig-name descname"><span class="pre">cuit</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;IntegerField:</span> <span class="pre">Clientes.cuit&gt;</span></em><a class="headerlink" href="#modelo.Clientes.cuit" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modelo.Clientes.id">
<span class="sig-name descname"><span class="pre">id</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;AutoField:</span> <span class="pre">Clientes.id&gt;</span></em><a class="headerlink" href="#modelo.Clientes.id" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modelo.Clientes.nombre">
<span class="sig-name descname"><span class="pre">nombre</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;CharField:</span> <span class="pre">Clientes.nombre&gt;</span></em><a class="headerlink" href="#modelo.Clientes.nombre" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modelo.Clientes.rubro">
<span class="sig-name descname"><span class="pre">rubro</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;CharField:</span> <span class="pre">Clientes.rubro&gt;</span></em><a class="headerlink" href="#modelo.Clientes.rubro" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<img alt="i1.png" src="i1.png" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Clientes</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">   </span><span class="sd">&quot;&quot;&quot;- Clase que representa la tabla &#39;Clientes&#39; en la base de datos.</span>

<span class="sd">   defininimos entonces...</span>
<span class="sd">   &quot;&quot;&quot;</span>
   <span class="n">nombre</span> <span class="o">=</span> <span class="n">CharField</span><span class="p">()</span>
   <span class="n">apellido</span> <span class="o">=</span> <span class="n">CharField</span><span class="p">()</span>
   <span class="n">rubro</span> <span class="o">=</span> <span class="n">CharField</span><span class="p">()</span>
   <span class="n">cuit</span> <span class="o">=</span> <span class="n">IntegerField</span><span class="p">()</span>
   <span class="n">clave_fiscal</span> <span class="o">=</span> <span class="n">CharField</span><span class="p">()</span>

<span class="w">   </span><span class="sd">&quot;&quot;&quot;- Luego se establece la conexion. &quot;&quot;&quot;</span>

<span class="n">midb</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
<span class="n">midb</span><span class="o">.</span><span class="n">create_tables</span><span class="p">([</span><span class="n">Clientes</span><span class="p">])</span>
</pre></div>
</div>
<p class="rubric">:: ManejoErrores</p>
<hr class="docutils" />
<ul class="simple">
<li><p>Clase que gestiona los registros de errores y operaciones del usuario. Contiene métodos estáticos para registrar errores en archivos de registro y mostrar mensajes de error al usuario.</p></li>
</ul>
<dl class="py class">
<dt class="sig sig-object py" id="modelo.ManejoErrores">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modelo.</span></span><span class="sig-name descname"><span class="pre">ManejoErrores</span></span><a class="reference internal" href="_modules/modelo.html#ManejoErrores"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelo.ManejoErrores" title="Link to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="modelo.ManejoErrores.registrar_error">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">registrar_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mensaje</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelo.html#ManejoErrores.registrar_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelo.ManejoErrores.registrar_error" title="Link to this definition"></a></dt>
<dd><ul class="simple">
<li><p>Funcion registro de error: Registra un error en el archivo ‘errores.txt’ y muestra un mensaje de error.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mensaje</strong> (<em>str</em>) – El mensaje de error a registrar.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modelo.ManejoErrores.registrar_movimiento">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">registrar_movimiento</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mensaje</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelo.html#ManejoErrores.registrar_movimiento"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelo.ManejoErrores.registrar_movimiento" title="Link to this definition"></a></dt>
<dd><ul class="simple">
<li><p>Funcion registro de accion: Registra una operación del usuario en el archivo ‘root.txt’.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mensaje</strong> (<em>str</em>) – El mensaje de la operación a registrar.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<img alt="i1.png" src="i1.png" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ManejoErrores</span><span class="p">():</span>
<span class="w">   </span><span class="sd">&quot;&quot;&quot;- Clase que gestiona los registros de errores y operaciones del usuario.&quot;&quot;&quot;</span>

   <span class="nd">@staticmethod</span>
   <span class="k">def</span> <span class="nf">registrar_error</span><span class="p">(</span><span class="n">mensaje</span><span class="p">):</span>
<span class="w">      </span><span class="sd">&quot;&quot;&quot;- Funcion registro de error: Registra un error en el archivo &#39;errores.txt&#39; y muestra un mensaje de error.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="n">error</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Se ha dado un error, </span><span class="si">{</span><span class="n">mensaje</span><span class="si">}</span><span class="s2">&quot;</span>
      <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;errores.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">log</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">error</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
      <span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Error&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>

   <span class="nd">@staticmethod</span>
   <span class="k">def</span> <span class="nf">registrar_movimiento</span><span class="p">(</span><span class="n">mensaje</span><span class="p">):</span>
<span class="w">      </span><span class="sd">&quot;&quot;&quot;- Funcion registro de accion: Registra una operación del usuario en el archivo &#39;root.txt&#39;.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;root.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">log</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">mensaje</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">:: FuncionesBotonera</p>
<hr class="docutils" />
<ul class="simple">
<li><p>Proporciona métodos para gestionar la interacción de botones en la interfaz gráfica, como agregar clientes, eliminar clientes y modificar datos de clientes en una base de datos. Estos métodos facilitan el manejo de eventos de usuario y la actualización de la interfaz en una aplicación de gestión de clientes.</p></li>
</ul>
<dl class="py class">
<dt class="sig sig-object py" id="modelo.FuncionesBotonera">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modelo.</span></span><span class="sig-name descname"><span class="pre">FuncionesBotonera</span></span><a class="reference internal" href="_modules/modelo.html#FuncionesBotonera"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelo.FuncionesBotonera" title="Link to this definition"></a></dt>
<dd><ul class="simple">
<li><p>Clase que contiene las funciones para la botonera de la interfaz.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Show-inheritance<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="modelo.FuncionesBotonera.abrir_afip">
<span class="sig-name descname"><span class="pre">abrir_afip</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelo.html#FuncionesBotonera.abrir_afip"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelo.FuncionesBotonera.abrir_afip" title="Link to this definition"></a></dt>
<dd><ul class="simple">
<li><p>Funcion para direccion a AFIP: Abre la página de AFIP en un navegador web.</p></li>
</ul>
<p>Utilizacion de webbrowser, acceso directo hacia la pagina para el registro.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modelo.FuncionesBotonera.actualizar_treeview">
<span class="sig-name descname"><span class="pre">actualizar_treeview</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mi_tree_view</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelo.html#FuncionesBotonera.actualizar_treeview"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelo.FuncionesBotonera.actualizar_treeview" title="Link to this definition"></a></dt>
<dd><ul class="simple">
<li><p>Funcion de actulaizar: Actualiza el Treeview con los registros de la base de datos.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mi_tree_view</strong> – Treeview que se debe actualizar.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modelo.FuncionesBotonera.alta">
<span class="sig-name descname"><span class="pre">alta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nombre</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apellido</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rubro</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cuit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clave_fiscal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelo.html#FuncionesBotonera.alta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelo.FuncionesBotonera.alta" title="Link to this definition"></a></dt>
<dd><ul class="simple">
<li><p>Funcion Alta: Agrega un nuevo cliente a la base de datos y actualiza el Treeview.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nombre</strong> – Nombre del cliente.</p></li>
<li><p><strong>apellido</strong> – Apellido del cliente.</p></li>
<li><p><strong>rubro</strong> – Rubro u oficio del cliente.</p></li>
<li><p><strong>cuit</strong> – CUIT/CUIL del cliente.</p></li>
<li><p><strong>clave_fiscal</strong> – Clave fiscal del cliente.</p></li>
<li><p><strong>tree</strong> – Treeview que se debe actualizar.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modelo.FuncionesBotonera.borrar">
<span class="sig-name descname"><span class="pre">borrar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelo.html#FuncionesBotonera.borrar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelo.FuncionesBotonera.borrar" title="Link to this definition"></a></dt>
<dd><ul class="simple">
<li><p>Funcion borrar cliente: Elimina un cliente seleccionado del Treeview y de la base de datos.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tree</strong> – Treeview que contiene al cliente a eliminar.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modelo.FuncionesBotonera.consultar">
<span class="sig-name descname"><span class="pre">consultar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nombre</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apellido</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rubro</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cuit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clave_fiscal</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelo.html#FuncionesBotonera.consultar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelo.FuncionesBotonera.consultar" title="Link to this definition"></a></dt>
<dd><ul class="simple">
<li><p>Funcion Consultamos: Consulta los datos de un cliente seleccionado en el Treeview.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tree</strong> – Treeview que contiene al cliente a consultar.</p></li>
<li><p><strong>nombre</strong> – Variable para almacenar el nombre del cliente consultado.</p></li>
<li><p><strong>apellido</strong> – Variable para almacenar el apellido del cliente consultado.</p></li>
<li><p><strong>rubro</strong> – Variable para almacenar el rubro u oficio del cliente consultado.</p></li>
<li><p><strong>cuit</strong> – Variable para almacenar el CUIT/CUIL del cliente consultado.</p></li>
<li><p><strong>clave_fiscal</strong> – Variable para almacenar la clave fiscal del cliente consultado.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modelo.FuncionesBotonera.maximizar_minimizar_ventana">
<span class="sig-name descname"><span class="pre">maximizar_minimizar_ventana</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelo.html#FuncionesBotonera.maximizar_minimizar_ventana"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelo.FuncionesBotonera.maximizar_minimizar_ventana" title="Link to this definition"></a></dt>
<dd><ul class="simple">
<li><p>Funcion minimizar y maximizar: Maximiza o minimiza la ventana.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tree</strong> – Treeview para ocultar o mostrar en la ventana.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modelo.FuncionesBotonera.modificar">
<span class="sig-name descname"><span class="pre">modificar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nombre</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apellido</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rubro</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cuit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clave_fiscal</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelo.html#FuncionesBotonera.modificar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelo.FuncionesBotonera.modificar" title="Link to this definition"></a></dt>
<dd><ul class="simple">
<li><p>Funcion Modificar clientes: Modifica los datos de un cliente seleccionado en el Treeview y en la base de datos.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tree</strong> – Treeview que contiene al cliente a modificar.</p></li>
<li><p><strong>nombre</strong> – Nuevo nombre del cliente.</p></li>
<li><p><strong>apellido</strong> – Nuevo apellido del cliente.</p></li>
<li><p><strong>rubro</strong> – Nuevo rubro u oficio del cliente.</p></li>
<li><p><strong>cuit</strong> – Nuevo CUIT/CUIL del cliente.</p></li>
<li><p><strong>clave_fiscal</strong> – Nueva clave fiscal del cliente.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modelo.FuncionesBotonera.mostrar_mensaje">
<span class="sig-name descname"><span class="pre">mostrar_mensaje</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">titulo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mensaje</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelo.html#FuncionesBotonera.mostrar_mensaje"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelo.FuncionesBotonera.mostrar_mensaje" title="Link to this definition"></a></dt>
<dd><ul class="simple">
<li><p>Funcion para mensajes emergentes: Muestra un mensaje de información.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>titulo</strong> – Título del mensaje.</p></li>
<li><p><strong>mensaje</strong> – Contenido del mensaje.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modelo.FuncionesBotonera.toggle_password">
<span class="sig-name descname"><span class="pre">toggle_password</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">show_password_var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entry</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_char</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelo.html#FuncionesBotonera.toggle_password"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelo.FuncionesBotonera.toggle_password" title="Link to this definition"></a></dt>
<dd><ul class="simple">
<li><p>Funcion ver/o no ver pass: Muestra u oculta la contraseña en el campo de entrada.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>show_password_var</strong> – Variable de control para mostrar u ocultar la contraseña.</p></li>
<li><p><strong>entry</strong> – Campo de entrada de la contraseña.</p></li>
<li><p><strong>show_char</strong> – Carácter a mostrar en lugar de la contraseña.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modelo.FuncionesBotonera.validar_campos">
<span class="sig-name descname"><span class="pre">validar_campos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nombre</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apellido</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rubro</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cuit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clave_fiscal</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelo.html#FuncionesBotonera.validar_campos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelo.FuncionesBotonera.validar_campos" title="Link to this definition"></a></dt>
<dd><ul class="simple">
<li><p>Funcion para Validar: Valida que todos los campos estén completos.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nombre</strong> – Nombre del cliente.</p></li>
<li><p><strong>apellido</strong> – Apellido del cliente.</p></li>
<li><p><strong>rubro</strong> – Rubro u oficio del cliente.</p></li>
<li><p><strong>cuit</strong> – CUIT/CUIL del cliente.</p></li>
<li><p><strong>clave_fiscal</strong> – Clave fiscal del cliente.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True si todos los campos están completos, False en caso contrario.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<img alt="i1.png" src="i1.png" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">FuncionesBotonera</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">   </span><span class="sd">&quot;&quot;&quot;- Clase que contiene las funciones para la botonera de la interfaz.&quot;&quot;&quot;</span>

   <span class="k">def</span> <span class="nf">alta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nombre</span><span class="p">,</span> <span class="n">apellido</span><span class="p">,</span> <span class="n">rubro</span><span class="p">,</span> <span class="n">cuit</span><span class="p">,</span> <span class="n">clave_fiscal</span><span class="p">,</span> <span class="n">tree</span><span class="p">):</span>
<span class="w">      </span><span class="sd">&quot;&quot;&quot;- Funcion Alta: Agrega un nuevo cliente a la base de datos y actualiza el Treeview.</span>

<span class="sd">      Este if verifica si la función validar_campos devuelve False, lo que significa que uno o más campos no están completos.</span>
<span class="sd">      En ese caso, se muestra un mensaje de error y la función alta retorna, evitando que se ejecute el código restante.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">validar_campos</span><span class="p">(</span><span class="n">nombre</span><span class="p">,</span> <span class="n">apellido</span><span class="p">,</span> <span class="n">rubro</span><span class="p">,</span> <span class="n">cuit</span><span class="p">,</span> <span class="n">clave_fiscal</span><span class="p">):</span>
            <span class="n">ManejoErrores</span><span class="o">.</span><span class="n">registrar_error</span><span class="p">(</span><span class="s2">&quot;Por favor, complete todos los campos.&quot;</span><span class="p">)</span>
            <span class="k">return</span>

      <span class="k">try</span><span class="p">:</span>                                                <span class="c1">#lanza la excepcion</span>
            <span class="n">noticia</span> <span class="o">=</span> <span class="n">Clientes</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
               <span class="n">nombre</span><span class="o">=</span><span class="n">nombre</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
               <span class="n">apellido</span><span class="o">=</span><span class="n">apellido</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>                  <span class="c1">#Con el .get() llamamos cuando ahce el alta.</span>
               <span class="n">rubro</span><span class="o">=</span><span class="n">rubro</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
               <span class="n">cuit</span><span class="o">=</span><span class="n">cuit</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
               <span class="n">clave_fiscal</span><span class="o">=</span><span class="n">clave_fiscal</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
            <span class="p">)</span>

            <span class="n">ManejoErrores</span><span class="o">.</span><span class="n">registrar_movimiento</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Haz agregado un nuevo cliente llamado/a </span><span class="si">{</span><span class="n">noticia</span><span class="o">.</span><span class="n">nombre</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">noticia</span><span class="o">.</span><span class="n">apellido</span><span class="si">}</span><span class="s2"> con CUIT: </span><span class="si">{</span><span class="n">noticia</span><span class="o">.</span><span class="n">cuit</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actualizar_treeview</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>             <span class="c1">#(Notificacion en el .txt)</span>
      <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">ManejoErrores</span><span class="o">.</span><span class="n">registrar_error</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>      <span class="c1">#Caso contrario Notifica el error.</span>

<span class="k">def</span> <span class="nf">toggle_password</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">show_password_var</span><span class="p">,</span> <span class="n">entry</span><span class="p">,</span> <span class="n">show_char</span><span class="p">):</span>
<span class="w">   </span><span class="sd">&quot;&quot;&quot;- Funcion ver/o no ver pass: Muestra u oculta la contraseña en el campo de entrada.</span>
<span class="sd">   &quot;&quot;&quot;</span>
   <span class="k">if</span> <span class="n">show_password_var</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>  <span class="c1"># Si la variable show_password_var es True</span>
      <span class="n">entry</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">show</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># Configura el campo de entrada para mostrar la contraseña</span>
   <span class="k">else</span><span class="p">:</span>
      <span class="n">entry</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">show</span><span class="o">=</span><span class="n">show_char</span><span class="p">)</span>  <span class="c1"># Configura el campo de entrada para ocultar la contraseña</span>

<span class="k">def</span> <span class="nf">abrir_afip</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">   </span><span class="sd">&quot;&quot;&quot;- Funcion para direccion a AFIP: Abre la página de AFIP en un navegador web.</span>

<span class="sd">   Utilización de webbrowser, acceso directo hacia la página para el registro.</span>
<span class="sd">   &quot;&quot;&quot;</span>
   <span class="n">webbrowser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;https://www.afip.gob.ar/landing/default.asp&quot;</span><span class="p">)</span>  <span class="c1"># Abre la página de AFIP en un navegador web</span>

<span class="k">def</span> <span class="nf">actualizar_treeview</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mi_tree_view</span><span class="p">):</span>
<span class="w">   </span><span class="sd">&quot;&quot;&quot;- Funcion de actulaizar: Actualiza el Treeview con los registros de la base de datos.</span>
<span class="sd">   &quot;&quot;&quot;</span>
   <span class="n">records</span> <span class="o">=</span> <span class="n">mi_tree_view</span><span class="o">.</span><span class="n">get_children</span><span class="p">()</span>  <span class="c1"># Obtiene los registros actuales del Treeview</span>
   <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">records</span><span class="p">:</span>
      <span class="n">mi_tree_view</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>  <span class="c1"># Borra todos los registros actuales del Treeview</span>

   <span class="k">for</span> <span class="n">fila</span> <span class="ow">in</span> <span class="n">Clientes</span><span class="o">.</span><span class="n">select</span><span class="p">():</span>  <span class="c1"># Itera sobre todos los registros de la tabla Clientes</span>
      <span class="n">mi_tree_view</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">fila</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="p">(</span><span class="n">fila</span><span class="o">.</span><span class="n">nombre</span><span class="p">,</span> <span class="n">fila</span><span class="o">.</span><span class="n">apellido</span><span class="p">,</span> <span class="n">fila</span><span class="o">.</span><span class="n">rubro</span><span class="p">,</span> <span class="n">fila</span><span class="o">.</span><span class="n">cuit</span><span class="p">,</span> <span class="n">fila</span><span class="o">.</span><span class="n">clave_fiscal</span><span class="p">))</span>  <span class="c1"># Inserta cada registro en el Treeview</span>

<span class="k">def</span> <span class="nf">borrar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tree</span><span class="p">):</span>
<span class="w">   </span><span class="sd">&quot;&quot;&quot;- Funcion borrar cliente: Elimina un cliente seleccionado del Treeview y de la base de datos.</span>
<span class="sd">   &quot;&quot;&quot;</span>
   <span class="n">valor</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">selection</span><span class="p">()</span>  <span class="c1"># Obtiene el valor seleccionado en el Treeview</span>
   <span class="k">if</span> <span class="ow">not</span> <span class="n">valor</span><span class="p">:</span>  <span class="c1"># Si no hay ningún valor seleccionado</span>
      <span class="n">ManejoErrores</span><span class="o">.</span><span class="n">registrar_error</span><span class="p">(</span><span class="s2">&quot;Por favor, seleccione un cliente para eliminar.&quot;</span><span class="p">)</span>  <span class="c1"># Muestra un mensaje de error</span>
      <span class="k">return</span>

   <span class="n">respuesta</span> <span class="o">=</span> <span class="n">askquestion</span><span class="p">(</span><span class="s2">&quot;Confirmar&quot;</span><span class="p">,</span> <span class="s2">&quot;¿Estás seguro que deseas eliminar este cliente?&quot;</span><span class="p">)</span>  <span class="c1"># Muestra un cuadro de diálogo de confirmación</span>
   <span class="k">if</span> <span class="n">respuesta</span> <span class="o">==</span> <span class="s1">&#39;yes&#39;</span><span class="p">:</span>  <span class="c1"># Si el usuario confirma la eliminación</span>
      <span class="n">item</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">valor</span><span class="p">)</span>  <span class="c1"># Obtiene el ítem seleccionado en el Treeview</span>
      <span class="n">nombre</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Obtiene el nombre del cliente a eliminar</span>
      <span class="n">apellido</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Obtiene el apellido del cliente a eliminar</span>
      <span class="n">cuit</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>  <span class="c1"># Obtiene el CUIT del cliente a eliminar</span>
      <span class="n">borrado</span> <span class="o">=</span> <span class="n">Clientes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Clientes</span><span class="o">.</span><span class="n">nombre</span> <span class="o">==</span> <span class="n">nombre</span><span class="p">,</span> <span class="n">Clientes</span><span class="o">.</span><span class="n">apellido</span> <span class="o">==</span> <span class="n">apellido</span><span class="p">,</span> <span class="n">Clientes</span><span class="o">.</span><span class="n">cuit</span> <span class="o">==</span> <span class="n">cuit</span><span class="p">)</span>  <span class="c1"># Obtiene el registro de la base de datos correspondiente al cliente a eliminar</span>
      <span class="n">borrado</span><span class="o">.</span><span class="n">delete_instance</span><span class="p">()</span>  <span class="c1"># Elimina el registro de la base de datos</span>
      <span class="n">tree</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">valor</span><span class="p">)</span>  <span class="c1"># Elimina el cliente seleccionado del Treeview</span>
      <span class="n">ManejoErrores</span><span class="o">.</span><span class="n">registrar_movimiento</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cliente </span><span class="si">{</span><span class="n">nombre</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">apellido</span><span class="si">}</span><span class="s2"> con CUIT </span><span class="si">{</span><span class="n">cuit</span><span class="si">}</span><span class="s2"> eliminado correctamente.&quot;</span><span class="p">)</span>  <span class="c1"># Registra la eliminación en el registro de movimientos</span>

<span class="k">def</span> <span class="nf">modificar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tree</span><span class="p">,</span> <span class="n">nombre</span><span class="p">,</span> <span class="n">apellido</span><span class="p">,</span> <span class="n">rubro</span><span class="p">,</span> <span class="n">cuit</span><span class="p">,</span> <span class="n">clave_fiscal</span><span class="p">):</span>
<span class="w">   </span><span class="sd">&quot;&quot;&quot;- Funcion Modificar clientes: Modifica los datos de un cliente seleccionado en el Treeview y en la base de datos.</span>
<span class="sd">   &quot;&quot;&quot;</span>
   <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">validar_campos</span><span class="p">(</span><span class="n">nombre</span><span class="p">,</span> <span class="n">apellido</span><span class="p">,</span> <span class="n">rubro</span><span class="p">,</span> <span class="n">cuit</span><span class="p">,</span> <span class="n">clave_fiscal</span><span class="p">):</span>  <span class="c1"># Si los campos no están completos</span>
      <span class="n">ManejoErrores</span><span class="o">.</span><span class="n">registrar_error</span><span class="p">(</span><span class="s2">&quot;Por favor, complete todos los campos para modificar un cliente.&quot;</span><span class="p">)</span>  <span class="c1"># Muestra un mensaje de error</span>
      <span class="k">return</span>

   <span class="n">valor</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">selection</span><span class="p">()</span>  <span class="c1"># Obtiene el valor seleccionado en el Treeview</span>
   <span class="k">if</span> <span class="ow">not</span> <span class="n">valor</span><span class="p">:</span>  <span class="c1"># Si no hay ningún valor seleccionado</span>
      <span class="n">ManejoErrores</span><span class="o">.</span><span class="n">registrar_error</span><span class="p">(</span><span class="s2">&quot;Por favor, seleccione un cliente para modificar.&quot;</span><span class="p">)</span>  <span class="c1"># Muestra un mensaje de error</span>
      <span class="k">return</span>

   <span class="n">item</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">valor</span><span class="p">)</span>  <span class="c1"># Obtiene el ítem seleccionado en el Treeview</span>
   <span class="n">nombre_actual</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Obtiene el nombre actual del cliente</span>
   <span class="n">apellido_actual</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Obtiene el apellido actual del cliente</span>
   <span class="n">cuit_actual</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>  <span class="c1"># Obtiene el CUIT actual del cliente</span>

   <span class="n">respuesta</span> <span class="o">=</span> <span class="n">askquestion</span><span class="p">(</span><span class="s2">&quot;Confirmar&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;¿Estás seguro que deseas modificar al cliente </span><span class="si">{</span><span class="n">nombre_actual</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">apellido_actual</span><span class="si">}</span><span class="s2"> con CUIT </span><span class="si">{</span><span class="n">cuit_actual</span><span class="si">}</span><span class="s2">.?&quot;</span><span class="p">)</span>  <span class="c1"># Muestra un cuadro de diálogo de confirmación</span>
   <span class="k">if</span> <span class="n">respuesta</span> <span class="o">==</span> <span class="s1">&#39;yes&#39;</span><span class="p">:</span>  <span class="c1"># Si el usuario confirma la modificación</span>
      <span class="n">nombre_antiguo</span> <span class="o">=</span> <span class="n">nombre_actual</span>  <span class="c1"># Guarda el nombre antiguo del cliente</span>
      <span class="n">apellido_antiguo</span> <span class="o">=</span> <span class="n">apellido_actual</span>  <span class="c1"># Guarda el apellido antiguo del cliente</span>
      <span class="n">cuit_antiguo</span> <span class="o">=</span> <span class="n">cuit_actual</span>  <span class="c1"># Guarda el CUIT antiguo del cliente</span>

      <span class="c1"># Actualiza los datos del cliente en la base de datos</span>
      <span class="n">actualizar</span> <span class="o">=</span> <span class="n">Clientes</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
            <span class="n">nombre</span><span class="o">=</span><span class="n">nombre</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
            <span class="n">apellido</span><span class="o">=</span><span class="n">apellido</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
            <span class="n">rubro</span><span class="o">=</span><span class="n">rubro</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
            <span class="n">cuit</span><span class="o">=</span><span class="n">cuit</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
            <span class="n">clave_fiscal</span><span class="o">=</span><span class="n">clave_fiscal</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
      <span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Clientes</span><span class="o">.</span><span class="n">nombre</span> <span class="o">==</span> <span class="n">nombre_actual</span><span class="p">,</span> <span class="n">Clientes</span><span class="o">.</span><span class="n">apellido</span> <span class="o">==</span> <span class="n">apellido_actual</span><span class="p">,</span> <span class="n">Clientes</span><span class="o">.</span><span class="n">cuit</span> <span class="o">==</span> <span class="n">cuit_actual</span><span class="p">)</span>
      <span class="n">actualizar</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>

      <span class="n">nombre_nuevo</span> <span class="o">=</span> <span class="n">nombre</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>  <span class="c1"># Obtiene el nuevo nombre del cliente</span>
      <span class="n">apellido_nuevo</span> <span class="o">=</span> <span class="n">apellido</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>  <span class="c1"># Obtiene el nuevo apellido del cliente</span>
      <span class="n">cuit_nuevo</span> <span class="o">=</span> <span class="n">cuit</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>  <span class="c1"># Obtiene el nuevo CUIT del cliente</span>

      <span class="n">ManejoErrores</span><span class="o">.</span><span class="n">registrar_movimiento</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cliente </span><span class="si">{</span><span class="n">nombre_antiguo</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">apellido_antiguo</span><span class="si">}</span><span class="s2"> con CUIT </span><span class="si">{</span><span class="n">cuit_antiguo</span><span class="si">}</span><span class="s2"> modificado a </span><span class="si">{</span><span class="n">nombre_nuevo</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">apellido_nuevo</span><span class="si">}</span><span class="s2"> con CUIT </span><span class="si">{</span><span class="n">cuit_nuevo</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># Registra la modificación en el registro de movimientos</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">actualizar_treeview</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>  <span class="c1"># Actualiza el Treeview</span>

<span class="k">def</span> <span class="nf">consultar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tree</span><span class="p">,</span> <span class="n">nombre</span><span class="p">,</span> <span class="n">apellido</span><span class="p">,</span> <span class="n">rubro</span><span class="p">,</span> <span class="n">cuit</span><span class="p">,</span> <span class="n">clave_fiscal</span><span class="p">):</span>
<span class="w">   </span><span class="sd">&quot;&quot;&quot;- Funcion Consultamos: Consulta los datos de un cliente seleccionado en el Treeview.</span>
<span class="sd">   &quot;&quot;&quot;</span>
   <span class="n">valor</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">selection</span><span class="p">()</span>  <span class="c1"># Obtiene el valor seleccionado en el Treeview</span>
   <span class="k">if</span> <span class="ow">not</span> <span class="n">valor</span><span class="p">:</span>  <span class="c1"># Si no hay ningún valor seleccionado</span>
      <span class="n">ManejoErrores</span><span class="o">.</span><span class="n">registrar_error</span><span class="p">(</span><span class="s2">&quot;Por favor, seleccione un cliente para consultar.&quot;</span><span class="p">)</span>  <span class="c1"># Muestra un mensaje de error</span>
      <span class="k">return</span>

   <span class="n">item</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">valor</span><span class="p">)</span>  <span class="c1"># Obtiene el ítem seleccionado en el Treeview</span>
   <span class="n">nombre_actual</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Obtiene el nombre actual del cliente</span>
   <span class="n">apellido_actual</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Obtiene el apellido actual del cliente</span>
   <span class="n">cuit_actual</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>  <span class="c1"># Obtiene el CUIT actual del cliente</span>
   <span class="n">consulta</span> <span class="o">=</span> <span class="n">Clientes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Clientes</span><span class="o">.</span><span class="n">nombre</span> <span class="o">==</span> <span class="n">nombre_actual</span><span class="p">,</span> <span class="n">Clientes</span><span class="o">.</span><span class="n">apellido</span> <span class="o">==</span> <span class="n">apellido_actual</span><span class="p">,</span> <span class="n">Clientes</span><span class="o">.</span><span class="n">cuit</span> <span class="o">==</span> <span class="n">cuit_actual</span><span class="p">)</span>  <span class="c1"># Realiza la consulta en la base de datos</span>

   <span class="c1"># Establece los valores de los campos en la interfaz con los datos consultados</span>
   <span class="n">nombre</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">consulta</span><span class="o">.</span><span class="n">nombre</span><span class="p">)</span>
   <span class="n">apellido</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">consulta</span><span class="o">.</span><span class="n">apellido</span><span class="p">)</span>
   <span class="n">rubro</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">consulta</span><span class="o">.</span><span class="n">rubro</span><span class="p">)</span>
   <span class="n">cuit</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">consulta</span><span class="o">.</span><span class="n">cuit</span><span class="p">)</span>
   <span class="n">clave_fiscal</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">consulta</span><span class="o">.</span><span class="n">clave_fiscal</span><span class="p">)</span>
   <span class="n">ManejoErrores</span><span class="o">.</span><span class="n">registrar_movimiento</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Consulta de cliente </span><span class="si">{</span><span class="n">nombre_actual</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">apellido_actual</span><span class="si">}</span><span class="s2"> con CUIT </span><span class="si">{</span><span class="n">cuit_actual</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>  <span class="c1"># Registra la consulta en el registro de movimientos</span>

<span class="k">def</span> <span class="nf">mostrar_mensaje</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">titulo</span><span class="p">,</span> <span class="n">mensaje</span><span class="p">):</span>
<span class="w">   </span><span class="sd">&quot;&quot;&quot;- Funcion para mensajes emergentes: Muestra un mensaje de información.</span>
<span class="sd">   &quot;&quot;&quot;</span>
   <span class="n">showinfo</span><span class="p">(</span><span class="n">titulo</span><span class="p">,</span> <span class="n">mensaje</span><span class="p">)</span>  <span class="c1"># Muestra un cuadro de diálogo con un mensaje de información</span>

<span class="k">def</span> <span class="nf">maximizar_minimizar_ventana</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tree</span><span class="p">):</span>
<span class="w">   </span><span class="sd">&quot;&quot;&quot;- Funcion minimizar y maximizar: Maximiza o minimiza la ventana.</span>
<span class="sd">   &quot;&quot;&quot;</span>
   <span class="k">if</span> <span class="n">tree</span><span class="o">.</span><span class="n">winfo_ismapped</span><span class="p">():</span>  <span class="c1"># Si la ventana está visible</span>
      <span class="n">tree</span><span class="o">.</span><span class="n">grid_remove</span><span class="p">()</span>  <span class="c1"># Remueve la ventana</span>
   <span class="k">else</span><span class="p">:</span>
      <span class="n">tree</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>  <span class="c1"># Muestra la ventana</span>

<span class="k">def</span> <span class="nf">validar_campos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nombre</span><span class="p">,</span> <span class="n">apellido</span><span class="p">,</span> <span class="n">rubro</span><span class="p">,</span> <span class="n">cuit</span><span class="p">,</span> <span class="n">clave_fiscal</span><span class="p">):</span>
<span class="w">   </span><span class="sd">&quot;&quot;&quot;- Funcion para Validar: Valida que todos los campos estén completos.</span>
<span class="sd">   &quot;&quot;&quot;</span>
   <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="n">nombre</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> <span class="n">apellido</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> <span class="n">rubro</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> <span class="n">cuit</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> <span class="n">clave_fiscal</span><span class="o">.</span><span class="n">get</span><span class="p">()]):</span>  <span class="c1"># Si alguno de los campos está vacío</span>
      <span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Error&quot;</span><span class="p">,</span> <span class="s2">&quot;Todos los campos son obligatorios&quot;</span><span class="p">)</span>  <span class="c1"># Muestra un mensaje de error</span>
      <span class="k">return</span> <span class="kc">False</span>  <span class="c1"># Retorna False indicando que la validación falló</span>
   <span class="k">return</span> <span class="kc">True</span>  <span class="c1"># Retorna True indicando que la validación fue exitosa</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="vista.html" class="btn btn-neutral float-left" title="Vista" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="controlador.html" class="btn btn-neutral float-right" title="Controlador" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Nahuel Matias Fortuna.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>